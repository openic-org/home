
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Manuel Monge">
      
      
        <link rel="canonical" href="https://openic.org/iris-128/iris-128s/adapter_iris128s/">
      
      
        <link rel="prev" href="../headstage_iris128s/">
      
      
        <link rel="next" href="../quickstart_iris128s/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Adapter - OpenIC Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#adapter" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="OpenIC Documentation" class="md-header__button md-logo" aria-label="OpenIC Documentation" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OpenIC Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Adapter
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/openic-org/docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    openic-org/docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="OpenIC Documentation" class="md-nav__button md-logo" aria-label="OpenIC Documentation" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    OpenIC Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/openic-org/docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    openic-org/docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Iris 128
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Iris 128
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../iris-128b/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Iris 128B
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Iris 128B
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../iris-128b/headstage_iris128B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Headstage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../iris-128b/adapter_iris128B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adapter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../iris-128b/quickstart_iris128B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Iris 128S
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Iris 128S
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../headstage_iris128s/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Headstage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Adapter
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Adapter
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#power-management-unit-pmu" class="md-nav__link">
    <span class="md-ellipsis">
      
        Power Management Unit - PMU
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Power Management Unit - PMU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#power-source-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Power Source Inputs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ground-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ground Scheme
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ground Scheme">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ground-domains" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ground Domains
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#power-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Power Requirements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Power Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#power-requirement-estimation-per-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        Power Requirement Estimation per Block
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-current-requirement-estimation-per-regulator" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output Current Requirement Estimation per Regulator
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        Block Diagram
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microcontroller-unit-mcu-stm32u083" class="md-nav__link">
    <span class="md-ellipsis">
      
        Microcontroller Unit - MCU STM32U083
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Microcontroller Unit - MCU STM32U083">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pin-assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pin Assignment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pin-connections" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pin Connections
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pin Connections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#power-pins-vdd-1-17-vdda-5-gnd-16-32" class="md-nav__link">
    <span class="md-ellipsis">
      
        Power: Pins VDD (1, 17), VDDA (5), &amp; GND (16, 32)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#swd-pins-swdio-23-swclk-24" class="md-nav__link">
    <span class="md-ellipsis">
      
        SWD: Pins SWDIO (23), SWCLK (24)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot0-pin-boot0-31" class="md-nav__link">
    <span class="md-ellipsis">
      
        BOOT0: Pin BOOT0 (31)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reset-pin-nrst-4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reset: Pin NRST (4)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lf-external-oscillator-2-pc14-osc32_in-3-pc15-osc32_out" class="md-nav__link">
    <span class="md-ellipsis">
      
        LF External Oscillator (2, PC14-OSC32_IN; 3, PC15-OSC32_OUT)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#j4-programming-connector" class="md-nav__link">
    <span class="md-ellipsis">
      
        J4 - Programming Connector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#j5-gpio-connector" class="md-nav__link">
    <span class="md-ellipsis">
      
        J5 - GPIO Connector
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-programming-the-adapter-mcu" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Programming the Adapter MCU
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Programming the Adapter MCU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mcu-peripherals-used-in-the-project" class="md-nav__link">
    <span class="md-ellipsis">
      
        MCU Peripherals used in the Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MCU Peripherals used in the Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gpios" class="md-nav__link">
    <span class="md-ellipsis">
      
        GPIOs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spi-block-in-mcu" class="md-nav__link">
    <span class="md-ellipsis">
      
        SPI Block in MCU
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-flashing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building &amp; Flashing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changing-the-state-of-the-switches" class="md-nav__link">
    <span class="md-ellipsis">
      
        Changing the State of the Switches
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Changing the State of the Switches">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example Code
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fw-variables-values-for-recording-through-rhd2164-chips" class="md-nav__link">
    <span class="md-ellipsis">
      
        FW variables values for recording through RHD2164 chips
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fw-variables-values-for-stim-through-rs0" class="md-nav__link">
    <span class="md-ellipsis">
      
        FW variables values for Stim through RS0
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#further-development" class="md-nav__link">
    <span class="md-ellipsis">
      
        Further Development
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pcb" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCB
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PCB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pcb-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCB Specifications
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart_iris128s/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../thin-film/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Thin-Film
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Thin-Film
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    License
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    License
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LICENSE.txt" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LICENSE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../NOTICE.txt" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NOTICE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../tutorials/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/xschem-pcell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Xschem with Pcells
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#power-management-unit-pmu" class="md-nav__link">
    <span class="md-ellipsis">
      
        Power Management Unit - PMU
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Power Management Unit - PMU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#power-source-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Power Source Inputs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ground-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ground Scheme
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ground Scheme">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ground-domains" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ground Domains
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#power-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Power Requirements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Power Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#power-requirement-estimation-per-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        Power Requirement Estimation per Block
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-current-requirement-estimation-per-regulator" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output Current Requirement Estimation per Regulator
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        Block Diagram
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microcontroller-unit-mcu-stm32u083" class="md-nav__link">
    <span class="md-ellipsis">
      
        Microcontroller Unit - MCU STM32U083
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Microcontroller Unit - MCU STM32U083">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pin-assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pin Assignment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pin-connections" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pin Connections
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pin Connections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#power-pins-vdd-1-17-vdda-5-gnd-16-32" class="md-nav__link">
    <span class="md-ellipsis">
      
        Power: Pins VDD (1, 17), VDDA (5), &amp; GND (16, 32)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#swd-pins-swdio-23-swclk-24" class="md-nav__link">
    <span class="md-ellipsis">
      
        SWD: Pins SWDIO (23), SWCLK (24)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot0-pin-boot0-31" class="md-nav__link">
    <span class="md-ellipsis">
      
        BOOT0: Pin BOOT0 (31)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reset-pin-nrst-4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reset: Pin NRST (4)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lf-external-oscillator-2-pc14-osc32_in-3-pc15-osc32_out" class="md-nav__link">
    <span class="md-ellipsis">
      
        LF External Oscillator (2, PC14-OSC32_IN; 3, PC15-OSC32_OUT)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#j4-programming-connector" class="md-nav__link">
    <span class="md-ellipsis">
      
        J4 - Programming Connector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#j5-gpio-connector" class="md-nav__link">
    <span class="md-ellipsis">
      
        J5 - GPIO Connector
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-programming-the-adapter-mcu" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Programming the Adapter MCU
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Programming the Adapter MCU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mcu-peripherals-used-in-the-project" class="md-nav__link">
    <span class="md-ellipsis">
      
        MCU Peripherals used in the Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MCU Peripherals used in the Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gpios" class="md-nav__link">
    <span class="md-ellipsis">
      
        GPIOs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spi-block-in-mcu" class="md-nav__link">
    <span class="md-ellipsis">
      
        SPI Block in MCU
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-flashing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building &amp; Flashing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changing-the-state-of-the-switches" class="md-nav__link">
    <span class="md-ellipsis">
      
        Changing the State of the Switches
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Changing the State of the Switches">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example Code
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fw-variables-values-for-recording-through-rhd2164-chips" class="md-nav__link">
    <span class="md-ellipsis">
      
        FW variables values for recording through RHD2164 chips
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fw-variables-values-for-stim-through-rs0" class="md-nav__link">
    <span class="md-ellipsis">
      
        FW variables values for Stim through RS0
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#further-development" class="md-nav__link">
    <span class="md-ellipsis">
      
        Further Development
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pcb" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCB
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PCB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pcb-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCB Specifications
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../../" class="md-path__link">
          
  <span class="md-ellipsis">
    Iris 128
  </span>

        </a>
      </li>
    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../" class="md-path__link">
          
  <span class="md-ellipsis">
    Iris 128S
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="adapter">Adapter</h1>
<p>The adapter consists of a 36-pin Omnetics connector, a 12-pin Omnetics connector, a 16-pin Omnetics connector, a power management unit (PMU) block, a microcontroller unit (MCU), and a programmer connector. This system is shown in the figure below.</p>
<pre class="mermaid"><code>graph LR
    %% PCB Definition
    PCB1[Headstage]

    subgraph PCB2[Adapter]
        direction LR

        subgraph b5["PMU-MCU"]
            direction TB
            c1[PMU]
            c2[MCU]
            c1 --&gt; c2
        end

        conn1["Omnetics-16
               Conn"]
        conn0["Omnetics-12
               Conn"]
        subgraph b4["36-Pin Conn"]
            e6[12]
            e7[14]
            e8[10]
        end

        e6 &lt;--&gt; conn0
        e6 &lt;--&gt; b5    
        e7 &lt;--&gt; conn1
        e8 &lt;--&gt; b5

    end

    b0["128 Electrode Array
        with matching
        Connector"]

    %% Top-level connections
    b0 &lt;--&gt; PCB1
    PCB1 &lt;----&gt; b4
    conn1 &lt;--&gt; i1["Intan Rec/Stim
                 Controller"]
    conn0 &lt;--&gt; i0["Intan Rec
                 Controller"]
    b5 &lt;--&gt; Programmer
</code></pre>
<p style="text-align:center"><i><b>Figure 1.</b> System architecutre of the Adapter.</i></p>

<p><br></p>
<p>The figure below shows the different components of the adapter.</p>
<p><img alt="" src="../../images/iris-128s-adapter-marked-top.jpg" /></p>
<p><img alt="" src="../../images/iris-128s-adapter-marked-bottom.jpg" /></p>
<p style="text-align:center"><i><b>Figure 2.</b> Rendering of the Adapter top and bottom sides indicating its main components.</i></p>

<p><br></p>
<p>The table below shows the main components of the Iris-128S adapter. Note the component correspondance with the previous figure.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Component</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>RHD +3.3V</code></td>
<td style="text-align: left;">64-ch neural recording amplifier chip, Intan.</td>
</tr>
<tr>
<td style="text-align: center;"><code>RHS +3.3V</code></td>
<td style="text-align: left;">16-ch neural recording/stimulation chip, Intan.</td>
</tr>
<tr>
<td style="text-align: center;"><code>J1-1</code></td>
<td style="text-align: left;"><code>RHD +3.3V</code> pin header.</td>
</tr>
<tr>
<td style="text-align: center;"><code>J7-1</code></td>
<td style="text-align: left;"><code>VDD3V</code> pin header. This +3 V supply is generated by the <code>PMU</code>.</td>
</tr>
<tr>
<td style="text-align: center;"><code>J2-1</code></td>
<td style="text-align: left;"><code>VDD_SW</code> pin header. This +9 V supply is generated by the <code>PMU</code>.</td>
</tr>
<tr>
<td style="text-align: center;"><code>J3-1</code></td>
<td style="text-align: left;"><code>VSS_SW</code> pin header. This -9 V supply is generated by the <code>PMU</code>.</td>
</tr>
<tr>
<td style="text-align: center;"><code>J1-2</code>, <code>J7-2</code> <br> <code>J2-2</code>, <code>J3-2</code></td>
<td style="text-align: left;"><code>GND</code> pin headers.</td>
</tr>
<tr>
<td style="text-align: center;"><code>A79623-001</code></td>
<td style="text-align: left;">12-pin high-density connector, Omnetics.</td>
</tr>
<tr>
<td style="text-align: center;"><code>A79633-001</code></td>
<td style="text-align: left;">16-pin high-density connector, Omnetics.</td>
</tr>
<tr>
<td style="text-align: center;"><code>A79024-001</code></td>
<td style="text-align: left;">36-pin high-density connector, Omnetics.</td>
</tr>
<tr>
<td style="text-align: center;"><code>J4</code></td>
<td style="text-align: left;">SWD 10-pin 0.05' pitch <code>Programming Port</code>.</td>
</tr>
<tr>
<td style="text-align: center;"><code>J6</code></td>
<td style="text-align: left;"><code>Reset Button</code> connected to the MCU.</td>
</tr>
<tr>
<td style="text-align: center;"><code>J5</code></td>
<td style="text-align: left;"><code>Expansion Port</code> with MCU GPIOs.</td>
</tr>
<tr>
<td style="text-align: center;"><code>STM32U0</code></td>
<td style="text-align: left;"><code>STM32U083KCU6</code> Ultra-low-power Arm M0+, 32-bit MCU.</td>
</tr>
<tr>
<td style="text-align: center;"><code>PMU</code></td>
<td style="text-align: left;">Power management unit which generaters +3 V and &plusmn;9 V.</td>
</tr>
<tr>
<td style="text-align: center;"><code>X1</code></td>
<td style="text-align: left;"><code>ECX-1210B</code> 32.768 kHz Crystal.</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="power-management-unit-pmu">Power Management Unit - PMU</h2>
<p>The PMU scheme is to provide the analog switches and MCU with their required voltages without altering the performance of the supply going to the Intan chips. We are placing regulators between any device's voltage supply and the power signal coming from the Intan Recording Controller. Switching noise coming from switching regulators could couple-back into the power input source through the regulators and potentially modify Intan chips performance. To minimize this effect, we are choosing switching regulators with a high switching frequency of &gt; 1 MHz. The 64-Ch Intan Recording chip has two 32-input ADCs which digitize the analog inputs at 30 kSa/s per channel. The signal at the input of these ADCs is then sampled at 32 <span class="arithmatex">\(\times\)</span> 30 kSa/s = 960 kHz. Assuming Nyquist, the frequency content of the ADC input is then 480 kHz. The ADP5070 has a switching frequency of 1.2/2.4 MHz which is outside of this signal bandwidth. We will use the switching frequency of 2.4 MHz.</p>
<h3 id="power-source-inputs">Power Source Inputs</h3>
<table>
<thead>
<tr>
<th style="text-align: center;">Input (Connector)</th>
<th style="text-align: center;">S1 (Omnetics-12)</th>
<th style="text-align: center;">S4 (Omnetics-16)</th>
<th style="text-align: center;">Pin Headers</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>VDD</code> Pin</td>
<td style="text-align: center;">T6</td>
<td style="text-align: center;">T8</td>
<td style="text-align: center;"><code>J1</code>-<code>J7</code></td>
</tr>
<tr>
<td style="text-align: center;"><code>GND</code> Pin</td>
<td style="text-align: center;">B6</td>
<td style="text-align: center;">B8</td>
<td style="text-align: center;"><code>J1</code>-<code>J7</code></td>
</tr>
<tr>
<td style="text-align: center;">Source</td>
<td style="text-align: center;">Rec Controller</td>
<td style="text-align: center;">Stim Controller</td>
<td style="text-align: center;">Unknown</td>
</tr>
<tr>
<td style="text-align: center;">Input Voltage</td>
<td style="text-align: center;">+3.2 - 3.6 V</td>
<td style="text-align: center;">+3.2 - 3.6 V</td>
<td style="text-align: center;">+3.3 V</td>
</tr>
</tbody>
</table>
<h3 id="ground-scheme">Ground Scheme</h3>
<p>We have a total of 3 different grounds in the system. These are <code>GND1</code> from the Recording controller, <code>GND2</code> from the Stimulation controller, and <code>GND3</code> from the Pin Headers. We use a commong ground plane for both <code>GND1</code> and <code>GND2</code>, and two connection points between <code>GND1</code> and <code>GND3</code> planes using <code>Net_Ties</code> close to connectors <code>S4</code> and <code>S5</code>.</p>
<h4 id="ground-domains">Ground Domains</h4>
<table>
<thead>
<tr>
<th style="text-align: center;">GND Domain</th>
<th style="text-align: center;">Components</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>GND1</code> = <code>GND2</code></td>
<td style="text-align: center;">2x RHD2164 &amp; 1x RHS2116</td>
</tr>
<tr>
<td style="text-align: center;"><code>GND3</code></td>
<td style="text-align: center;">PMU + MCU + Switches</td>
</tr>
</tbody>
</table>
<h3 id="power-requirements">Power Requirements</h3>
<h4 id="power-requirement-estimation-per-block">Power Requirement Estimation per Block</h4>
<table>
<thead>
<tr>
<th style="text-align: center;">Component</th>
<th style="text-align: center;">Current</th>
<th style="text-align: center;"># Devices</th>
<th style="text-align: center;">Total</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>STM32U083</code> - Core @ 3.0V (Run Mode)</td>
<td style="text-align: center;">54 uA/MHz</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">52 uA</td>
</tr>
<tr>
<td style="text-align: center;"><code>STM32U083</code> - I/O - Static/Leakage @ 3.0V</td>
<td style="text-align: center;">10uA + #I/Os*0.1 uA</td>
<td style="text-align: center;">20 I/Os</td>
<td style="text-align: center;">12 uA</td>
</tr>
<tr>
<td style="text-align: center;"><code>STM32U083</code> - I/O - Dynamic @ 3.0V</td>
<td style="text-align: center;">Negligable,<br>not switching expected</td>
<td style="text-align: center;">N/A</td>
<td style="text-align: center;">0 uA</td>
</tr>
<tr>
<td style="text-align: center;"><code>STM32U083</code> - Peripherals @ 3.0V</td>
<td style="text-align: center;">~ 35 uA/MHz</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">35 uA</td>
</tr>
<tr>
<td style="text-align: center;"><code>STM32U083</code> - Programming</td>
<td style="text-align: center;">~10 mA</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">10 mA</td>
</tr>
<tr>
<td style="text-align: center;"><code>ADGS5414</code> - IDD</td>
<td style="text-align: center;">&lt; 500 uA</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">4 mA</td>
</tr>
<tr>
<td style="text-align: center;"><code>ADGS5414</code> - ISS</td>
<td style="text-align: center;">1 uA</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">8 uA</td>
</tr>
<tr>
<td style="text-align: center;"><code>ADGS5414</code> - IL (1 MHz)</td>
<td style="text-align: center;">30 uA</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">240 uA</td>
</tr>
</tbody>
</table>
<h4 id="output-current-requirement-estimation-per-regulator">Output Current Requirement Estimation per Regulator</h4>
<table>
<thead>
<tr>
<th style="text-align: center;">Regulator</th>
<th style="text-align: center;">Supply</th>
<th style="text-align: center;">Voltage</th>
<th style="text-align: center;">Iout (Max)</th>
<th style="text-align: center;">Components</th>
<th style="text-align: center;">Required Output Current (Max)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>ADP7142</code></td>
<td style="text-align: center;"><code>VDD_SW</code></td>
<td style="text-align: center;">+9 V</td>
<td style="text-align: center;">200 mA</td>
<td style="text-align: center;"><code>ADGS5414</code> - VDD</td>
<td style="text-align: center;">4 mA</td>
</tr>
<tr>
<td style="text-align: center;"><code>ADP7182</code></td>
<td style="text-align: center;"><code>VSS_SW</code></td>
<td style="text-align: center;">-9 V</td>
<td style="text-align: center;">200 mA</td>
<td style="text-align: center;"><code>ADGS5414</code> - VSS</td>
<td style="text-align: center;">8 uA</td>
</tr>
<tr>
<td style="text-align: center;"><code>TLV711</code> - Vout1</td>
<td style="text-align: center;"><code>VDD3V</code></td>
<td style="text-align: center;">+3 V</td>
<td style="text-align: center;">200 mA</td>
<td style="text-align: center;"><code>ADGS5414</code> - VL<br><code>STM32U083</code> - VDD<br><code>STM32U083</code> - Programming</td>
<td style="text-align: center;">240 uA<br>100 uA<br>~10 mA</td>
</tr>
<tr>
<td style="text-align: center;"><code>TLV711</code> - Vout2</td>
<td style="text-align: center;"><code>VDDA3V</code></td>
<td style="text-align: center;">+3 V</td>
<td style="text-align: center;">200 mA</td>
<td style="text-align: center;"><code>STM32U083</code> - VDDA</td>
<td style="text-align: center;">50 uA</td>
</tr>
</tbody>
</table>
<h3 id="block-diagram">Block Diagram</h3>
<pre class="mermaid"><code>graph LR
    i1["`**VDD1 
        Recording
        Controller)**
        3.2-3.6V`"]

    subgraph pmu["`**PMU**`"]
    subgraph s1["`**ADP5070 - 1A/0.6A**`"]
        ADP5070-Vin["Vin
                     2.85-15V"]
        ADP5070-VoutPOS["VoutPOS
                         Up to 39V"]
        ADP5070-VoutNEG["VoutNEG
                         Down to -39V"]
        ADP5070-Vin --&gt; ADP5070-VoutPOS
        ADP5070-Vin --&gt; ADP5070-VoutNEG
    end

    subgraph s2["`**ADP7142 - 200mA**`"]
        ADP7142-Vin["Vin
                     2.85-15V"]
        ADP7142-Vout["Vout
                      Adj
                      +9V"]
        ADP7142-Vin --&gt; ADP7142-Vout
    end

    subgraph s3["`**ADP7182 - 200mA**`"]
        ADP7182-Vin["Vin
                     -2.7- -28V"]
        ADP7182-Vout["Vout
                      Adj
                      -9V"]
        ADP7182-Vin --&gt; ADP7182-Vout
    end

    subgraph s4["`**TLV711 - 200mA**`"]
        TLV711-Vin["Vin
                     2-5.5V"]
        TLV711-Vout1["Vout
                      Fixed
                      +3.0V"]
        TLV711-Vout2["Vout
                      Fixed
                      +3.0V"]
        TLV711-Vin --&gt; TLV711-Vout1
        TLV711-Vin --&gt; TLV711-Vout2
    end

    %% Connections

    ADP5070-VoutPOS --"`**VDDH**`"--&gt; ADP7142-Vin
    ADP5070-VoutNEG --"`**VSSH**`"--&gt; ADP7182-Vin

    end

    subgraph s5["`**ADGS5414**`"]
        ADGS5414-VL["VL
                     2.7-3.3V"]
        ADGS5414-VDD["VDD
                      +9V"]
        ADGS5414-VSS["VSS
                      -9V"]
    end

    subgraph s6["`**STM32U083**`"]
        STM32U083-VDDA["VDDA
                      1.62/1.8/2.4-3.6V"]
        STM32U083-VDD["VDD
                     1.71-3.6V"]        

    end

    %% Connections
    i1 --&gt; ADP5070-Vin
    ADP7142-Vout --&gt; out1["`**VDD_SW
                            +9V**`"]
    ADP7182-Vout --&gt; out2["`**VSS_SW
                            -9V**`"]
    i1 ----&gt; TLV711-Vin
    TLV711-Vout1 --&gt; out3["`**VDD3V
                           +3.0V**`"]
    TLV711-Vout2 --&gt; out4["`**VDDA3V
                           +3.0V**`"]
    out1 --&gt; ADGS5414-VDD
    out2 --&gt; ADGS5414-VSS
    out3 --&gt; ADGS5414-VL
    out3 --&gt; STM32U083-VDD
    out4 --&gt; STM32U083-VDDA</code></pre>
<p style="text-align:center"><i><b>Figure 3.</b> Block diagram of the PMU.</i></p>

<p><br></p>
<hr />
<h2 id="microcontroller-unit-mcu-stm32u083">Microcontroller Unit - MCU STM32U083</h2>
<h3 id="pin-assignment">Pin Assignment</h3>
<table>
<thead>
<tr>
<th style="text-align: center;">Pin Number</th>
<th style="text-align: center;">Pin Name</th>
<th style="text-align: center;">Assigned Function</th>
<th style="text-align: center;">Connection</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">VDD</td>
<td style="text-align: center;">Power</td>
<td style="text-align: center;">VDD3V</td>
</tr>
<tr>
<td style="text-align: center;">24</td>
<td style="text-align: center;">PA14 (SWCLK)</td>
<td style="text-align: center;">Prog.</td>
<td style="text-align: center;">J4-4 (PROG-SWD)</td>
</tr>
<tr>
<td style="text-align: center;">16, 32</td>
<td style="text-align: center;">GND</td>
<td style="text-align: center;">Power</td>
<td style="text-align: center;">GND</td>
</tr>
<tr>
<td style="text-align: center;">23</td>
<td style="text-align: center;">PA13 (SWDIO)</td>
<td style="text-align: center;">Prog.</td>
<td style="text-align: center;">J4-2 (PROG-SWD)</td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td style="text-align: center;">PF2-NRST</td>
<td style="text-align: center;">Reset/Prog.</td>
<td style="text-align: center;">J4-10 (PROG-SWD), J6 (Button)</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">VDDA/VREF+</td>
<td style="text-align: center;">Power</td>
<td style="text-align: center;">VDDA3V</td>
</tr>
<tr>
<td style="text-align: center;">17</td>
<td style="text-align: center;">VDD2</td>
<td style="text-align: center;">Power</td>
<td style="text-align: center;">VDD3V</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">PC14-OSC32_IN</td>
<td style="text-align: center;">OSC32</td>
<td style="text-align: center;">Ext. Crystal</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">PC15-OSC32_OUT</td>
<td style="text-align: center;">OSC32</td>
<td style="text-align: center;">Ext. Crystal</td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td style="text-align: center;">PA0-CK_IN</td>
<td style="text-align: center;">GPIO</td>
<td style="text-align: center;">J5-1 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">7</td>
<td style="text-align: center;">PA1</td>
<td style="text-align: center;">GPIO</td>
<td style="text-align: center;">J5-2 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">8</td>
<td style="text-align: center;">PA2</td>
<td style="text-align: center;">GPIO</td>
<td style="text-align: center;">J5-3 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">9</td>
<td style="text-align: center;">PA3</td>
<td style="text-align: center;">GPIO</td>
<td style="text-align: center;">J5-4 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">10</td>
<td style="text-align: center;">PA4</td>
<td style="text-align: center;">GPIO (DAC1_OUT1)</td>
<td style="text-align: center;">J5-5 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">11</td>
<td style="text-align: center;">PA5</td>
<td style="text-align: center;">GPIO</td>
<td style="text-align: center;">J5-6 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">12</td>
<td style="text-align: center;">PA6</td>
<td style="text-align: center;">GPIO</td>
<td style="text-align: center;">J5-7 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">13</td>
<td style="text-align: center;">PA7</td>
<td style="text-align: center;">GPIO</td>
<td style="text-align: center;">J5-8 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">14</td>
<td style="text-align: center;">PB0</td>
<td style="text-align: center;">GPIO (LPUART2_CTS)</td>
<td style="text-align: center;">J5-15 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">15</td>
<td style="text-align: center;">PB1</td>
<td style="text-align: center;">GPIO (LPUART2_RTS_DE)</td>
<td style="text-align: center;">J5-16 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">18</td>
<td style="text-align: center;">PA8</td>
<td style="text-align: center;">GPIO</td>
<td style="text-align: center;">LED D3</td>
</tr>
<tr>
<td style="text-align: center;">19</td>
<td style="text-align: center;">PA9</td>
<td style="text-align: center;">GPIO (I2C1_SCL)</td>
<td style="text-align: center;">J5-11, 4.7 k&Omega; pull-up</td>
</tr>
<tr>
<td style="text-align: center;">20</td>
<td style="text-align: center;">PA10</td>
<td style="text-align: center;">GPIO (I2C1_SDA)</td>
<td style="text-align: center;">J5-12, 4.7 k<span class="arithmatex">\(\Omega\)</span> pull-up</td>
</tr>
<tr>
<td style="text-align: center;">21</td>
<td style="text-align: center;">PA11</td>
<td style="text-align: center;">GPIO</td>
<td style="text-align: center;">J5-13 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">22</td>
<td style="text-align: center;">PA12</td>
<td style="text-align: center;">GPIO</td>
<td style="text-align: center;">J5-14 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">25</td>
<td style="text-align: center;">PA15</td>
<td style="text-align: center;">SPI3_NSS</td>
<td style="text-align: center;">CSb_SW</td>
</tr>
<tr>
<td style="text-align: center;">26</td>
<td style="text-align: center;">PB3</td>
<td style="text-align: center;">SPI3_SCK</td>
<td style="text-align: center;">SCLK_SW</td>
</tr>
<tr>
<td style="text-align: center;">27</td>
<td style="text-align: center;">PB4</td>
<td style="text-align: center;">SPI3_MISO</td>
<td style="text-align: center;">MISO_SW</td>
</tr>
<tr>
<td style="text-align: center;">28</td>
<td style="text-align: center;">PB5</td>
<td style="text-align: center;">SPI3_MOSI</td>
<td style="text-align: center;">MOSI_SW</td>
</tr>
<tr>
<td style="text-align: center;">29</td>
<td style="text-align: center;">PB6</td>
<td style="text-align: center;">GPIO (LPUART2_TX)</td>
<td style="text-align: center;">J5-17 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">30</td>
<td style="text-align: center;">PB7</td>
<td style="text-align: center;">GPIO (LPUART2_RX)</td>
<td style="text-align: center;">J5-18 (Pin-Header)</td>
</tr>
<tr>
<td style="text-align: center;">31</td>
<td style="text-align: center;">PF3-BOOT0</td>
<td style="text-align: center;">BOOT0</td>
<td style="text-align: center;">GND (via 0<span class="arithmatex">\(\Omega\)</span>)</td>
</tr>
<tr>
<td style="text-align: center;">33</td>
<td style="text-align: center;">Exposed Pad</td>
<td style="text-align: center;">Exposed Pad</td>
<td style="text-align: center;">GND</td>
</tr>
</tbody>
</table>
<h3 id="pin-connections">Pin Connections</h3>
<h4 id="power-pins-vdd-1-17-vdda-5-gnd-16-32">Power: Pins VDD (1, 17), VDDA (5), &amp; GND (16, 32)</h4>
<ul>
<li>V<sub>DD</sub>: External power supply for I/Os (V<sub>DDIO1</sub>), the internal regulator and the system analog.</li>
<li>V<sub>DDA</sub>: External power supply for embedded analog components. It is independent from V<sub>DD</sub>.</li>
<li>No power up/down sequence required.</li>
</ul>
<p><strong>Bypass Capacitors:</strong></p>
<ul>
<li><code>VDD</code> - <code>VSS</code><ul>
<li>1x 4.7 uF ceramic cap.</li>
<li>1x 100 nF ceramic cap per VDD pin.</li>
</ul>
</li>
<li><code>VDDA</code> - <code>VSS</code><ul>
<li>1x 1 uF ceramic cap.</li>
<li>1x 100 nF ceramic cap.</li>
<li>1x 10 nF ceramic cap.</li>
</ul>
</li>
</ul>
<h4 id="swd-pins-swdio-23-swclk-24">SWD: Pins SWDIO (23), SWCLK (24)</h4>
<ul>
<li>Connected to <code>J4</code> connector without any pull-up or pull-down resistors.</li>
</ul>
<h4 id="boot0-pin-boot0-31">BOOT0: Pin BOOT0 (31)</h4>
<ul>
<li>1x 0 &Omega; resistor to <code>GND</code>.</li>
</ul>
<h4 id="reset-pin-nrst-4">Reset: Pin NRST (4)</h4>
<ul>
<li>This pin is internally connected to a permanent pull-up resistor, R<sub>PU</sub>.</li>
<li>Connected to <code>J4</code> connector for programming and pulse-button switch to reset the device locally..</li>
<li>Filter capacitor of 0.1 uF to ground placed as close as possible to the device.</li>
</ul>
<h4 id="lf-external-oscillator-2-pc14-osc32_in-3-pc15-osc32_out">LF External Oscillator (2, PC14-OSC32_IN; 3, PC15-OSC32_OUT)</h4>
<p>The <code>X1</code> crystal used in the board is the <em>ECX-1210B</em> by <em>ECS</em>, with a C<sub>L</sub> = 6 pF.</p>
<h4 id="j4-programming-connector">J4 - Programming Connector</h4>
<table>
<thead>
<tr>
<th style="text-align: center;">Pin Number</th>
<th style="text-align: center;">Description</th>
<th style="text-align: center;">Pin Number</th>
<th style="text-align: center;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">T_VCC (VDD3V)</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">T_SWDIO (PA13)</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">GND</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">T_SWCLK (PA14)</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">GND</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">T_SWO (NC)</td>
</tr>
<tr>
<td style="text-align: center;">7</td>
<td style="text-align: center;">T_JRCLK/NC (NC)</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">T_JTDI/NC (NC)</td>
</tr>
<tr>
<td style="text-align: center;">9</td>
<td style="text-align: center;">GNDDetect (GND)</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">T_NRST (NRST)</td>
</tr>
</tbody>
</table>
<p><br></p>
<h4 id="j5-gpio-connector">J5 - GPIO Connector</h4>
<table>
<thead>
<tr>
<th style="text-align: center;">Pin Number</th>
<th style="text-align: center;">Description</th>
<th style="text-align: center;">Pin Number</th>
<th style="text-align: center;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">PA0</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">PA1</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">PA2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">PA3</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">PA4 (SPI1_NSS)</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">PA5 (SPI1_SCK)</td>
</tr>
<tr>
<td style="text-align: center;">7</td>
<td style="text-align: center;">PA6 (SPI1_MISO)</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">PA7 (SPI1_MOSI)</td>
</tr>
<tr>
<td style="text-align: center;">9</td>
<td style="text-align: center;">GND</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">VDD3V</td>
</tr>
<tr>
<td style="text-align: center;">11</td>
<td style="text-align: center;">PA9 (I2C1_SCL)</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">PA10 (I2C1_SDA)</td>
</tr>
<tr>
<td style="text-align: center;">13</td>
<td style="text-align: center;">PA11</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">PA12</td>
</tr>
<tr>
<td style="text-align: center;">15</td>
<td style="text-align: center;">PB0</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">PB1</td>
</tr>
<tr>
<td style="text-align: center;">17</td>
<td style="text-align: center;">PB6 (LPUART2_TX)</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">PB7 (LPUART2_RX)</td>
</tr>
<tr>
<td style="text-align: center;">19</td>
<td style="text-align: center;">GND</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">VDD3V</td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="3-programming-the-adapter-mcu">3. Programming the Adapter MCU</h2>
<h3 id="mcu-peripherals-used-in-the-project">MCU Peripherals used in the Project</h3>
<ol>
<li><code>RCC</code>: System clock configuration.</li>
<li><code>GPIO</code>: Configuring MCU I/Os.</li>
<li><code>SPI3</code>: SPI block.</li>
</ol>
<h4 id="gpios">GPIOs</h4>
<table>
<thead>
<tr>
<th>Pin<br>Name</th>
<th>Signal<br>on Pin</th>
<th>GPIO<br>Output Level</th>
<th>GPIO<br>Mode</th>
<th>GPIO<br>Pull-up/Pull-down</th>
</tr>
</thead>
<tbody>
<tr>
<td>PA8</td>
<td>N/A</td>
<td>Low</td>
<td>Output Push Pull</td>
<td>No pull-up/pull-down</td>
</tr>
<tr>
<td>PA15</td>
<td>N/A (SPI3_NSS)</td>
<td>Low</td>
<td>Output Push Pull</td>
<td>No pull-up/pull-down</td>
</tr>
<tr>
<td>PB3</td>
<td>SPI3_SCK</td>
<td>N/A</td>
<td>Alternate Function Push Pull</td>
<td>No pull-up/pull-down</td>
</tr>
<tr>
<td>PB4</td>
<td>SPI3_MISO</td>
<td>N/A</td>
<td>Alternate Function Push Pull</td>
<td>No pull-up/pull-down</td>
</tr>
<tr>
<td>PB5</td>
<td>SPI3_MOSI</td>
<td>N/A</td>
<td>Alternate Function Push Pull</td>
<td>No pull-up/pull-down</td>
</tr>
</tbody>
</table>
<h4 id="spi-block-in-mcu">SPI Block in MCU</h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mode</td>
<td>Full-Duplex Master</td>
</tr>
<tr>
<td>Frame Format</td>
<td>Motorola</td>
</tr>
<tr>
<td>Data Size</td>
<td>8 bits</td>
</tr>
<tr>
<td>First Bit</td>
<td>MSB first</td>
</tr>
<tr>
<td>Baud Rate</td>
<td>62.5 kb/s</td>
</tr>
<tr>
<td>CPOL</td>
<td>Low</td>
</tr>
<tr>
<td>CPHA</td>
<td>1 Edge</td>
</tr>
</tbody>
</table>
<h3 id="building-flashing">Building &amp; Flashing</h3>
<p>The <code>adapter</code> board has a <code>STM32U083</code> ultra-low-power Arm M0+ 32-bit microcontroller (MCU) which is used to program the state of the switches in the headstage through <code>SPI</code> communication. You can use any tool you want to build the firmware and program the MCU; here we use the <code>STM32Cube</code> tools. The figure below shows a screenshot of the <code>STM32CubeIDE</code> with the <code>main.c</code> file in the center panel. You can download all the project documents from our <a href="https://github.com/openic-org/iris-128">github repository</a>. To build the project, click on the <img alt="" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f528.svg" title=":hammer:" /> button.</p>
<p><img alt="" src="../../images/stm32cubeide.png" /></p>
<p style="text-align:center"><i><b>Figure 7.</b> Screenshoot of the <b>STM32CubeIDE</b> with the <b>main.c</b> file in the center panel.</i></p>

<p><br></p>
<p>To program the MCU, we use the <code>STM32CubeProgrammer</code>. Connect the <code>STLINK-V3</code> to the computer and the <code>adapter</code> board using the 10-pin ribbon cable. Press the <code>Connect</code> button to connect and identify the board. Program or <code>flash</code> the MCU by clicking on <code>Program</code>.</p>
<p><img alt="" src="../../images/stm32cubeprogrammer.png" /></p>
<p style="text-align:center"><i><b>Figure 8.</b> Screenshoot of the <b>STM32CubeProgrammer</b>.</i></p>

<p><br></p>
<h3 id="changing-the-state-of-the-switches">Changing the State of the Switches</h3>
<p>You can change the state of each of the switches in the eight octal <code>ADGS5414</code> by updating the values of the constants shown below. Notice that the bit <code>swX[Y]</code> corresponds to the <code>Y</code> switch of component <code>uX</code>, where <code>X</code>,<code>Y</code> <span class="arithmatex">\(\in \{1,2,...8 \}\)</span> . The value of <code>0</code> indicates the switch is open whereas the <code>1</code> indicates it is closed.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Function</th>
<th style="text-align: left;">Actions</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Recording</td>
<td style="text-align: left;"><code>OPEN</code> the switch to the RHS2116 and <code>CLOSE</code> the one to the RHD2164.</td>
</tr>
<tr>
<td style="text-align: center;">Stimulation</td>
<td style="text-align: left;"><code>CLOSE</code> the switch to the RHS2116 and <code>OPEN</code> the one to the RHD2164.</td>
</tr>
</tbody>
</table>
<h4 id="example-code">Example Code</h4>
<div class="language-c highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="cm">/* Switches states: swX=[7..0] */</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="c1">// Default values</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">sw1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)(</span><span class="mb">0b00000000</span><span class="p">);</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">sw2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)(</span><span class="mb">0b00000000</span><span class="p">);</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">sw3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)(</span><span class="mb">0b11111111</span><span class="p">);</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">sw4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)(</span><span class="mb">0b11111111</span><span class="p">);</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">sw5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)(</span><span class="mb">0b11111111</span><span class="p">);</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">sw6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)(</span><span class="mb">0b11111111</span><span class="p">);</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">sw7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)(</span><span class="mb">0b00000000</span><span class="p">);</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">sw8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)(</span><span class="mb">0b00000000</span><span class="p">);</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When configuring a stimulation channel, make sure to <code>OPEN</code> the switch connected to the <code>RHD2164</code>. Failure to do so can cause damage to the <code>RHD2164</code> due to the possibility of higher than expected voltages at its input.</p>
</div>
<h3 id="fw-variables-values-for-recording-through-rhd2164-chips">FW variables values for recording through RHD2164 chips</h3>
<table>
<thead>
<tr>
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">sw1</td>
<td style="text-align: center;">0b00000000</td>
</tr>
<tr>
<td style="text-align: center;">sw2</td>
<td style="text-align: center;">0b00000000</td>
</tr>
<tr>
<td style="text-align: center;">sw3</td>
<td style="text-align: center;">0b11111111</td>
</tr>
<tr>
<td style="text-align: center;">sw4</td>
<td style="text-align: center;">0b11111111</td>
</tr>
<tr>
<td style="text-align: center;">sw5</td>
<td style="text-align: center;">0b11111111</td>
</tr>
<tr>
<td style="text-align: center;">sw6</td>
<td style="text-align: center;">0b11111111</td>
</tr>
<tr>
<td style="text-align: center;">sw7</td>
<td style="text-align: center;">0b00000000</td>
</tr>
<tr>
<td style="text-align: center;">sw8</td>
<td style="text-align: center;">0b00000000</td>
</tr>
</tbody>
</table>
<h3 id="fw-variables-values-for-stim-through-rs0">FW variables values for Stim through RS0</h3>
<table>
<thead>
<tr>
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">sw1</td>
<td style="text-align: center;">0b00000000</td>
</tr>
<tr>
<td style="text-align: center;">sw2</td>
<td style="text-align: center;">0b00000000</td>
</tr>
<tr>
<td style="text-align: center;">sw3</td>
<td style="text-align: center;">0b11111111</td>
</tr>
<tr>
<td style="text-align: center;">sw4</td>
<td style="text-align: center;">0b11111111</td>
</tr>
<tr>
<td style="text-align: center;">sw5</td>
<td style="text-align: center;">0b10111111</td>
</tr>
<tr>
<td style="text-align: center;">sw6</td>
<td style="text-align: center;">0b11111111</td>
</tr>
<tr>
<td style="text-align: center;">sw7</td>
<td style="text-align: center;">0b00000000</td>
</tr>
<tr>
<td style="text-align: center;">sw8</td>
<td style="text-align: center;">0b00000010</td>
</tr>
</tbody>
</table>
<h3 id="further-development">Further Development</h3>
<p>The current use of the MCU is to program the state of the switches in the headstage after the <code>adapter</code> board is powered on. You could further expand the functions of the MCU to adapt the <code>Iris-128s</code> neural interface to your project. For this purpose, the <code>adapter</code> board features a <code>reset button</code>, a <code>32 kHz crystal</code>, and a <code>expansion port</code> with flexible <code>GPIO</code> for easy prototyping and development.</p>
<hr />
<h2 id="pcb">PCB</h2>
<p>The PCB for the <em>adapter</em> has a size of 50 x 40 mm<sup>2</sup>. The table below shows the PCB specifications.</p>
<h4 id="pcb-specifications">PCB Specifications</h4>
<table>
<thead>
<tr>
<th style="text-align: center;">PCB Specification</th>
<th style="text-align: center;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Size</td>
<td style="text-align: center;">50 x 40 mm<sup>2</sup></td>
</tr>
<tr>
<td style="text-align: center;">Trace Width/Space</td>
<td style="text-align: center;">5 mil / 5 mil</td>
</tr>
<tr>
<td style="text-align: center;">Layers</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: center;">Thru-Hole Via (Hole/Diameter)</td>
<td style="text-align: center;">10 mil / 20 mil</td>
</tr>
<tr>
<td style="text-align: center;">Thickness</td>
<td style="text-align: center;">0.062 in (1.6 mm)</td>
</tr>
<tr>
<td style="text-align: center;">Surface Finish</td>
<td style="text-align: center;">ENIG</td>
</tr>
<tr>
<td style="text-align: center;">Copper Weight</td>
<td style="text-align: center;">1 oz</td>
</tr>
<tr>
<td style="text-align: center;">Dielectric</td>
<td style="text-align: center;">Standard FR4</td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 - 2025 Manuel Monge
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.instant", "navigation.sections", "navigation.path", "navigation.indexes", "navigation.top", "content.code.copy", "content.code.select", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../javascripts/mermaid.mjs" type="module"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>